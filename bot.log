2025-06-03 15:09:47,098 - INFO - Running job "periodic_site_check_job (trigger: interval[0:01:00], next run at: 2025-06-03 11:10:47 UTC)" (scheduled at 2025-06-03 11:09:47.083900+00:00)
2025-06-03 15:09:47,098 - INFO - periodic_site_check_job running. Targeting up to 1 users with addresses.
2025-06-03 15:09:47,098 - INFO - Запуск периодической проверки для пользователя 7230593037 (tier: Free, частота: 21600s)
2025-06-03 15:09:47,098 - ERROR - No error handlers are registered, logging exception.
Traceback (most recent call last):
  File "C:\Users\Gevorg\Gevorg_computer\Diploma_work\My\Project_with_LM\phi-2.Q4_K_M\Project\smart_bot.py", line 1559, in periodic_site_check_job
    await check_site_for_user(user_id_int, context)
  File "C:\Users\Gevorg\Gevorg_computer\Diploma_work\My\Project_with_LM\phi-2.Q4_K_M\Project\smart_bot.py", line 490, in check_site_for_user
    lang = context.user_data.get(USER_DATA_LANG) or user_settings.get(user_id, {}).get("lang", "hy")
           ^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'get'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_jobqueue.py", line 997, in _run
    await self.callback(context)
  File "C:\Users\Gevorg\Gevorg_computer\Diploma_work\My\Project_with_LM\phi-2.Q4_K_M\Project\smart_bot.py", line 1563, in periodic_site_check_job
    log_error(f"Ошибка во время периодической проверки для пользователя {user_id_int}: {e}", exc_info=e)
TypeError: log_error() got an unexpected keyword argument 'exc_info'
2025-06-03 15:09:47,101 - INFO - Job "periodic_site_check_job (trigger: interval[0:01:00], next run at: 2025-06-03 11:10:47 UTC)" executed successfully
2025-06-03 15:09:47,384 - INFO - HTTP Request: POST https://api.telegram.org/botREMOVED/getUpdates "HTTP/1.1 409 Conflict"
2025-06-03 15:09:47,385 - ERROR - No error handlers are registered, logging exception.
Traceback (most recent call last):
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_utils\networkloop.py", line 115, in network_retry_loop
    if not await do_action():
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_utils\networkloop.py", line 108, in do_action
    return action_cb_task.result()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_updater.py", line 335, in polling_action_cb
    updates = await self.bot.get_updates(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_extbot.py", line 669, in get_updates
    updates = await super().get_updates(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\_bot.py", line 4601, in get_updates
    await self._post(
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\_bot.py", line 697, in _post
    return await self._do_post(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_extbot.py", line 369, in _do_post
    return await super()._do_post(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\_bot.py", line 726, in _do_post
    result = await request.post(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\request\_baserequest.py", line 197, in post
    result = await self._request_wrapper(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\request\_baserequest.py", line 355, in _request_wrapper
    raise Conflict(message)
telegram.error.Conflict: Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-06-03 15:09:54,237 - INFO - HTTP Request: POST https://api.telegram.org/botREMOVED/getUpdates "HTTP/1.1 409 Conflict"
2025-06-03 15:09:54,238 - ERROR - No error handlers are registered, logging exception.
Traceback (most recent call last):
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_utils\networkloop.py", line 115, in network_retry_loop
    if not await do_action():
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_utils\networkloop.py", line 108, in do_action
    return action_cb_task.result()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_updater.py", line 335, in polling_action_cb
    updates = await self.bot.get_updates(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_extbot.py", line 669, in get_updates
    updates = await super().get_updates(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\_bot.py", line 4601, in get_updates
    await self._post(
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\_bot.py", line 697, in _post
    return await self._do_post(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_extbot.py", line 369, in _do_post
    return await super()._do_post(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\_bot.py", line 726, in _do_post
    result = await request.post(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\request\_baserequest.py", line 197, in post
    result = await self._request_wrapper(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\request\_baserequest.py", line 355, in _request_wrapper
    raise Conflict(message)
telegram.error.Conflict: Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-06-03 15:09:59,952 - INFO - HTTP Request: POST https://api.telegram.org/botREMOVED/getUpdates "HTTP/1.1 409 Conflict"
2025-06-03 15:09:59,953 - ERROR - No error handlers are registered, logging exception.
Traceback (most recent call last):
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_utils\networkloop.py", line 115, in network_retry_loop
    if not await do_action():
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_utils\networkloop.py", line 108, in do_action
    return action_cb_task.result()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_updater.py", line 335, in polling_action_cb
    updates = await self.bot.get_updates(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_extbot.py", line 669, in get_updates
    updates = await super().get_updates(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\_bot.py", line 4601, in get_updates
    await self._post(
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\_bot.py", line 697, in _post
    return await self._do_post(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_extbot.py", line 369, in _do_post
    return await super()._do_post(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\_bot.py", line 726, in _do_post
    result = await request.post(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\request\_baserequest.py", line 197, in post
    result = await self._request_wrapper(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\request\_baserequest.py", line 355, in _request_wrapper
    raise Conflict(message)
telegram.error.Conflict: Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-06-03 15:10:08,504 - INFO - HTTP Request: POST https://api.telegram.org/botREMOVED/getUpdates "HTTP/1.1 409 Conflict"
2025-06-03 15:10:08,505 - ERROR - No error handlers are registered, logging exception.
Traceback (most recent call last):
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_utils\networkloop.py", line 115, in network_retry_loop
    if not await do_action():
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_utils\networkloop.py", line 108, in do_action
    return action_cb_task.result()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_updater.py", line 335, in polling_action_cb
    updates = await self.bot.get_updates(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_extbot.py", line 669, in get_updates
    updates = await super().get_updates(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\_bot.py", line 4601, in get_updates
    await self._post(
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\_bot.py", line 697, in _post
    return await self._do_post(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_extbot.py", line 369, in _do_post
    return await super()._do_post(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\_bot.py", line 726, in _do_post
    result = await request.post(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\request\_baserequest.py", line 197, in post
    result = await self._request_wrapper(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\request\_baserequest.py", line 355, in _request_wrapper
    raise Conflict(message)
telegram.error.Conflict: Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-06-03 15:10:21,490 - INFO - HTTP Request: POST https://api.telegram.org/botREMOVED/getUpdates "HTTP/1.1 409 Conflict"
2025-06-03 15:10:21,491 - ERROR - No error handlers are registered, logging exception.
Traceback (most recent call last):
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_utils\networkloop.py", line 115, in network_retry_loop
    if not await do_action():
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_utils\networkloop.py", line 108, in do_action
    return action_cb_task.result()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_updater.py", line 335, in polling_action_cb
    updates = await self.bot.get_updates(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_extbot.py", line 669, in get_updates
    updates = await super().get_updates(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\_bot.py", line 4601, in get_updates
    await self._post(
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\_bot.py", line 697, in _post
    return await self._do_post(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_extbot.py", line 369, in _do_post
    return await super()._do_post(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\_bot.py", line 726, in _do_post
    result = await request.post(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\request\_baserequest.py", line 197, in post
    result = await self._request_wrapper(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\request\_baserequest.py", line 355, in _request_wrapper
    raise Conflict(message)
telegram.error.Conflict: Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-06-03 15:10:39,304 - INFO - HTTP Request: POST https://api.telegram.org/botREMOVED/getUpdates "HTTP/1.1 200 OK"
2025-06-03 15:10:40,720 - INFO - HTTP Request: POST https://api.telegram.org/botREMOVED/getUpdates "HTTP/1.1 409 Conflict"
2025-06-03 15:10:40,721 - ERROR - No error handlers are registered, logging exception.
Traceback (most recent call last):
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_utils\networkloop.py", line 115, in network_retry_loop
    if not await do_action():
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_utils\networkloop.py", line 108, in do_action
    return action_cb_task.result()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_updater.py", line 335, in polling_action_cb
    updates = await self.bot.get_updates(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_extbot.py", line 669, in get_updates
    updates = await super().get_updates(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\_bot.py", line 4601, in get_updates
    await self._post(
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\_bot.py", line 697, in _post
    return await self._do_post(
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\ext\_extbot.py", line 369, in _do_post
    return await super()._do_post(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\_bot.py", line 726, in _do_post
    result = await request.post(
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\request\_baserequest.py", line 197, in post
    result = await self._request_wrapper(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Gevorg\AppData\Local\Programs\Python\Python311\Lib\site-packages\telegram\request\_baserequest.py", line 355, in _request_wrapper
    raise Conflict(message)
telegram.error.Conflict: Conflict: terminated by other getUpdates request; make sure that only one bot instance is running
2025-06-03 15:10:46,623 - INFO - HTTP Request: POST https://api.telegram.org/botREMOVED/getUpdates "HTTP/1.1 200 OK"
2025-06-03 15:10:46,623 - INFO - Application is stopping. This might take a moment.
2025-06-03 15:10:46,624 - INFO - Scheduler has been shut down
2025-06-03 15:10:46,625 - INFO - Application.stop() complete
2025-06-03 15:10:46,627 - INFO - Bot post_shutdown_hook: Сохранение данных перед выключением...
2025-06-03 15:10:46,631 - INFO - Резервная копия создана для user_settings.json в backups\user_settings.backup_20250603_151046.json
2025-06-03 15:10:46,634 - INFO - Данные успешно сохранены в user_settings.json
2025-06-03 15:10:46,636 - INFO - Удалена старая резервная копия: backups\user_settings.backup_20250602_040035.json
2025-06-03 15:10:46,640 - INFO - Резервная копия создана для addresses.json в backups\addresses.backup_20250603_151046.json
2025-06-03 15:10:46,643 - INFO - Данные успешно сохранены в addresses.json
2025-06-03 15:10:46,645 - INFO - Удалена старая резервная копия: backups\addresses.backup_20250602_035944.json
2025-06-03 15:10:46,649 - INFO - Резервная копия создана для notified.json в backups\notified.backup_20250603_151046.json
2025-06-03 15:10:46,651 - INFO - Данные успешно сохранены в notified.json
2025-06-03 15:10:46,653 - INFO - Удалена старая резервная копия: backups\notified.backup_20250602_035944.json
2025-06-03 15:10:46,655 - INFO - Данные успешно сохранены в bot_general_status.json
2025-06-03 15:10:46,655 - INFO - Данные успешно сохранены. Bot выключается.
2025-06-03 15:10:46,656 - INFO - Бот остановлен.
2025-06-03 15:10:52,519 - INFO - LLaMA model loaded successfully from .\phi-2.q4_k_m.gguf with n_ctx=2048, n_threads=2
2025-06-03 15:10:53,694 - INFO - Загружены ID администраторов: [7230593037]
2025-06-03 15:10:53,695 - INFO - ЗАПУСК БОТА (версия от 2025-06-03 15:10:53)
2025-06-03 15:10:53,695 - INFO - Уровень логирования: INFO
2025-06-03 15:10:53,695 - INFO - Администраторы: [7230593037]
2025-06-03 15:10:55,904 - INFO - Application built successfully.
2025-06-03 15:11:38,785 - INFO - LLaMA model loaded successfully from .\phi-2.q4_k_m.gguf with n_ctx=2048, n_threads=2
2025-06-03 15:11:40,003 - INFO - Загружены ID администраторов: [7230593037]
2025-06-03 15:11:40,006 - INFO - ЗАПУСК БОТА (версия от 2025-06-03 15:11:40)
2025-06-03 15:11:40,006 - INFO - Уровень логирования: INFO
2025-06-03 15:11:40,006 - INFO - Администраторы: [7230593037]
2025-06-03 15:11:42,232 - INFO - Application built successfully.
